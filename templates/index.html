<!DOCTYPE html>
<html>
<head>
    <title>Route Finder</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
     <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
     <style>
        #map {
            height: 400px;
        }
    </style>
</head>
<body>
    <h2>Find a Route</h2>
    <form id="routeForm">
        <p>Inputs should be either postcodes or lat,long coordinates (no whitespace).</p>
        <label for="start">Start:</label><br>
        <input type="text" id="start" name="start" required><br>
        <label for="end">End:</label><br>
        <input type="text" id="end" name="end" required><br><br>
        <input type="button" value="Find Route" onclick="findRoute()">
    </form>

    <div id="map"></div>
    <script>
        var map = L.map('map').setView([51.505, -0.09], 13);
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

        function findRoute() {
            var start = document.getElementById('start').value;
            var end = document.getElementById('end').value;

            fetch('/getroute', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `start=${encodeURIComponent(start)}&end=${encodeURIComponent(end)}`
            })
            .then(response => response.json())
            .then(data => {
                drawRoute(data);
            })
            .catch(error => console.error('Error:', error));
        }


        function drawRoute(coordinates) {
            console.log(coordinates);

            var polyline = L.polyline(coordinates, {color: 'blue'}).addTo(map);
            map.fitBounds(polyline.getBounds());
        }
    </script>
</body>
</html>
